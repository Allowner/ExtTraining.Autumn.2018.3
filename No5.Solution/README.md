Существует большое количество дублируемого кода, а будет еще больше если будет больше форматов
Объединил все методы в один принимающий делегат.